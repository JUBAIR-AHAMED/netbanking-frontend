<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Transactions</title>
    <link rel="stylesheet" href="Css/mainframe.css">
    <link rel="stylesheet" href="Css/transaction.css">
</head>
<body>
    <div class="maincont">
        <div class="page">
            <div class="header">
                <div class="pageName">Bank Of Utopia</div>
                <div class="bar"></div>
                <div class="profileimg" onclick="toggleDropdown()">
                    <img src="/icons/10-profile-picture-ideas-to-make-you-stand-out (1).jpg" alt="Profile">
                    <div id="profileDropdown" class="dropdown-content">
                        <a href="/profile.html">View Profile</a>
                    </div>
                </div>
            </div>
            <div class="pagebody">
                <div class="transaction-form">
                    <div class="bank-logo">
                        <h2>Make Transactions</h2>
                    </div>
                    <form id="transactionForm">
                        <div class="form-group">
                            <select id="transactionType" name="transactionType" required style="background-color: white;" class="selected">
                                <option value="same-bank">Same Bank</option>
                                <option value="other-bank">Other Bank</option>
                            </select>
                            <label for="transactionType" class="floating-label">Transaction Type</label>
                        </div>
                        
                        <div id="otherBankFields" class="hidden">
                            <div class="form-group">
                                <select id="bankName" style="background-color: white;" class="selected">
                                    <option value="" disabled selected></option>
                                    <option value="bank1">Bank 1</option>
                                    <option value="bank2">Bank 2</option>
                                    <option value="bank3">Bank 3</option>
                                </select>
                                <label for="bankName" class="floating-label">Bank Name</label>
                            </div>
                            <div class="form-group">
                                <input type="text" id="ifscCode" placeholder="" maxlength="11">
                                <label for="ifscCode" class="floating-label">IFSC Code</label>
                            </div>
                        </div>
                        <!-- <div class="form-group">
                            <select id="fromAccountNumberDropdown" class="selected" style="background-color: white;" >
                            </select>
                            <label for="fromAccountNumberDropdown" class="floating-label">Sender Account</label>
                        </div> -->
                        <!-- <div class="form-group">
                            <input type="text" id="fromAccountNumber" class="form-control hidden" placeholder="Enter Account Number">
                            <select id="fromAccountNumberDropdown" class="form-control selected"></select>
                            <label id="fromAccountNumberLabel" class="floating-label">Sender Account Number</label>
                        </div> -->
                        <div class="form-group">
                            <input 
                            type="text" 
                            id="fromAccountNumber" 
                            class="form-control" 
                            placeholder="" 
                            autocomplete="off">
                            <label for="fromAccountNumber" class="floating-label">Sender Account Number</label>
                            <ul id="fromAccountDropdown" class="dropdown-menu"></ul>
                        </div>
                        
                        <div class="form-group">
                            <input type="text" id="toAccountNumber" placeholder="" maxlength="16">
                            <label for="toAccountNumber" class="floating-label">Receiver Account</label>
                        </div>
                        <div class="form-group">
                            <input type="text" id="amount" required placeholder="">
                            <label for="amount" class="floating-label">Amount</label>
                        </div>
                        <button class="submit-btn" type="submit">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script src="JavaScript/transaction.js"></script>
    <script src="JavaScript/bar.js"></script>
    <script>
        // Handle form submission
        document.getElementById('transactionForm').addEventListener('submit', function(event) {
            event.preventDefault();

            // Get values
            let fromAccountNumber = document.getElementById('fromAccountNumber').value;
            let toAccountNumber = document.getElementById('toAccountNumber').value;
            let ifscCode = document.getElementById('ifscCode').value;
            let amount = document.getElementById('amount').value;

            // Validate Sender Account
            if (!/^\d{16}$/.test(fromAccountNumber)) {
                alert('Sender account number must be exactly 16 digits.');
                return;
            }
            if (!/^\d{16}$/.test(toAccountNumber)) {
                alert('Receiver account number must be exactly 16 digits.');
                return;
            }

            // Validate IFSC Code
            if (!/^[A-Za-z]{4}\d{7}$/.test(ifscCode)) {
                alert('IFSC code must follow the pattern: 4 letters followed by 7 digits.');
                return;
            }

            // Validate Amount
            if (amount <= 0) {
                alert('Amount must be a positive number.');
                return;
            }

            // If all validations pass, submit the form (for now, just log the values)
            console.log('Transaction submitted:', {
                fromAccountNumber,
                toAccountNumber,
                ifscCode,
                amount
            });
        });

        // Optional: To toggle other bank fields based on transaction type
        document.getElementById('transactionType').addEventListener('change', function() {
            const otherBankFields = document.getElementById('otherBankFields');
            if (this.value === 'other-bank') {
                otherBankFields.classList.remove('hidden');
            } else {
                otherBankFields.classList.add('hidden');
            }
        });

        // Ensure only numeric input for account numbers and amount
        document.getElementById('fromAccountNumber').addEventListener('input', function(event) {
            let value = this.value;
            // Allow only numeric input and limit length to 16
            if (/[^0-9]/.test(value)) {
                this.value = value.replace(/[^0-9]/g, '');
            }
        });

        document.getElementById('toAccountNumber').addEventListener('input', function(event) {
            let value = this.value;
            // Allow only numeric input and limit length to 16
            if (/[^0-9]/.test(value)) {
                this.value = value.replace(/[^0-9]/g, '');
            }
        });

        document.getElementById('ifscCode').addEventListener('input', function(event) {
    let value = this.value;

    // Allow only alphanumeric characters
    value = value.replace(/[^A-Za-z0-9]/g, '');

    // Enforce the pattern: 4 letters followed by 7 digits
    if (value.length > 4 && value.length <= 7) {
        // Allow letters for the first 4 characters and digits for the next 7 characters
        value = value.substring(0, 4) + value.substring(4).replace(/[^0-9]/g, '');
    } else if (value.length > 7) {
        // Restrict total length to 11 (4 letters + 7 digits)
        value = value.substring(0, 11);
    }

    // Ensure the first 4 characters are letters and next 7 are digits
    if (value.length > 4 && value.length <= 7 && !/^[A-Za-z]{4}\d{0,7}$/.test(value)) {
        value = value.substring(0, 7); // Restrict to 7 characters
    }

    // Update the input field with the corrected value
    this.value = value;
});


        document.getElementById('amount').addEventListener('input', function(event) {
            let value = this.value;
            // Allow only numeric input
            if (/[^0-9.]/.test(value)) {
                this.value = value.replace(/[^0-9.]/g, '');
            }
            // Ensure it is a positive number
            if (parseFloat(this.value) <= 0) {
                this.value = '';
            }
        });
    </script>
</body>
</html>
